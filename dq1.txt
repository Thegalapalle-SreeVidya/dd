for col in df.columns:
    if df[col].nunique() > 3:
        if df[col].dtype in ["float64", "int64", "int32"]:
            try:
                result = psi_table_numerical(col, df, nodes, merged_df_benchmark_months, merged_df_validation_month)
                if result is not None and not result.empty:
                    psi_overall.append(result)
                else:
                    st.write(f"No results for numerical column: {col}")
            except Exception as e:
                st.error(f"Error processing numerical column {col}: {str(e)}")
        else:
            try:
                result = psi_table_categorical(col, df, nodes, merged_df_benchmark_months, merged_df_validation_month)
                if result is not None and not result.empty:
                    psi_overall.append(result)
                else:
                    st.write(f"No results for categorical column: {col}")
            except Exception as e:
                st.error(f"Error processing categorical column {col}: {str(e)}")
